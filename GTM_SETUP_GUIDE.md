# Gu√≠a de Configuraci√≥n Google Tag Manager + GA4 para Contadoor

## üìã √çndice
1. [Configuraci√≥n Inicial GTM](#1-configuraci√≥n-inicial-gtm)
2. [Configuraci√≥n GA4](#2-configuraci√≥n-ga4)
3. [Variables en GTM](#3-variables-en-gtm)
4. [Triggers (Activadores)](#4-triggers-activadores)
5. [Tags (Etiquetas)](#5-tags-etiquetas)
6. [Eventos Personalizados](#6-eventos-personalizados)
7. [Verificaci√≥n y Testing](#7-verificaci√≥n-y-testing)

---

## 1. Configuraci√≥n Inicial GTM

### ‚úÖ Ya implementado
- **Container ID**: `GTM-PHGF2PCM`
- Scripts de GTM instalados en `index.html`
- DataLayer configurado en el c√≥digo

### Pr√≥ximos pasos en GTM:
1. Ve a [Google Tag Manager](https://tagmanager.google.com/)
2. Selecciona tu container `GTM-PHGF2PCM`
3. Configura el workspace para desarrollo

---

## 2. Configuraci√≥n GA4

### Crear propiedad GA4:
1. Ve a [Google Analytics](https://analytics.google.com/)
2. Crea una nueva propiedad GA4
3. **Nombre**: "Contadoor - Aplicaci√≥n Web"
4. **URL**: Tu dominio principal
5. Copia el **MEASUREMENT ID** (formato: G-XXXXXXXXXX)

### Enhanced Ecommerce (opcional):
- Habilita "Enhanced Ecommerce" para tracking de cotizaciones
- Configura eventos de conversi√≥n personalizados

---

## 3. Variables en GTM

Crear estas variables personalizadas:

### 3.1 Variables de DataLayer

| Nombre Variable | Tipo | Nombre DataLayer |
|----------------|------|------------------|
| `DL - Event` | Variable de capa de datos | `event` |
| `DL - Page Title` | Variable de capa de datos | `page_title` |
| `DL - Page Path` | Variable de capa de datos | `page_path` |
| `DL - Button Name` | Variable de capa de datos | `button_name` |
| `DL - Section` | Variable de capa de datos | `section` |
| `DL - CTA Text` | Variable de capa de datos | `cta_text` |
| `DL - CTA Position` | Variable de capa de datos | `cta_position` |
| `DL - Form Name` | Variable de capa de datos | `form_name` |
| `DL - Form Type` | Variable de capa de datos | `form_type` |
| `DL - Quote Action` | Variable de capa de datos | `quote_action` |
| `DL - Quote Step` | Variable de capa de datos | `quote_step` |
| `DL - Flow Type` | Variable de capa de datos | `flow_type` |
| `DL - Conversion Type` | Variable de capa de datos | `conversion_type` |

### 3.2 Variables de JavaScript

```javascript
// Variable: Get Current Section
function() {
  var path = {{Page Path}};
  switch(path) {
    case '/': return 'homepage';
    case '/servicios': return 'services';
    case '/cotizador': return 'quote_calculator';
    case '/contacto': return 'contact';
    case '/como-funciona': return 'how_it_works';
    case '/por-que-contadoor': return 'why_contadoor';
    case '/sobre-nosotros': return 'about_us';
    case '/recursos': return 'resources';
    default: return 'other';
  }
}
```

---

## 4. Triggers (Activadores)

### 4.1 Trigger de Inicializaci√≥n
- **Nombre**: `GTM Init`
- **Tipo**: Inicializaci√≥n
- **Se activa en**: Todas las p√°ginas

### 4.2 Triggers de P√°ginas SPA
- **Nombre**: `SPA Page View`
- **Tipo**: Evento personalizado
- **Nombre del evento**: `page_view`

### 4.3 Triggers de Botones y CTAs
- **Nombre**: `Button Clicks`
- **Tipo**: Evento personalizado  
- **Nombre del evento**: `button_click`

- **Nombre**: `CTA Clicks`
- **Tipo**: Evento personalizado
- **Nombre del evento**: `cta_click`

### 4.4 Triggers de Formularios
- **Nombre**: `Form Start`
- **Tipo**: Evento personalizado
- **Nombre del evento**: `form_start`

- **Nombre**: `Form Submit`
- **Tipo**: Evento personalizado
- **Nombre del evento**: `form_submit`

### 4.5 Triggers del Cotizador
- **Nombre**: `Quote Start`
- **Tipo**: Evento personalizado
- **Nombre del evento**: `quote_calculator`
- **Condici√≥n**: `{{DL - Quote Action}}` equals `start`

- **Nombre**: `Quote Step Complete`  
- **Tipo**: Evento personalizado
- **Nombre del evento**: `quote_calculator`
- **Condici√≥n**: `{{DL - Quote Action}}` equals `step_complete`

- **Nombre**: `Quote Complete`
- **Tipo**: Evento personalizado  
- **Nombre del evento**: `quote_calculator`
- **Condici√≥n**: `{{DL - Quote Action}}` equals `complete`

- **Nombre**: `Quote Abandon`
- **Tipo**: Evento personalizado
- **Nombre del evento**: `quote_calculator`  
- **Condici√≥n**: `{{DL - Quote Action}}` equals `abandon`

### 4.6 Triggers de Conversiones
- **Nombre**: `Conversions`
- **Tipo**: Evento personalizado
- **Nombre del evento**: `conversion`

---

## 5. Tags (Etiquetas)

### 5.1 Tag Principal GA4
- **Nombre**: `GA4 Config`
- **Tipo**: Configuraci√≥n de Google Analytics: GA4
- **Measurement ID**: Tu ID de GA4 (G-XXXXXXXXXX)
- **Trigger**: `GTM Init`

### 5.2 Tags de Eventos GA4

#### Tag: GA4 Page Views
- **Nombre**: `GA4 - SPA Page View`
- **Tipo**: Evento de Google Analytics: GA4
- **Configuraci√≥n**: `{{GA4 Config}}`
- **Nombre del evento**: `page_view`
- **Par√°metros**:
  - `page_title`: `{{DL - Page Title}}`
  - `page_location`: `{{Page URL}}`
  - `page_path`: `{{DL - Page Path}}`
- **Trigger**: `SPA Page View`

#### Tag: GA4 Button Clicks
- **Nombre**: `GA4 - Button Clicks`
- **Tipo**: Evento de Google Analytics: GA4
- **Configuraci√≥n**: `{{GA4 Config}}`
- **Nombre del evento**: `button_click`
- **Par√°metros**:
  - `button_name`: `{{DL - Button Name}}`
  - `section`: `{{DL - Section}}`
  - `page_section`: `{{Get Current Section}}`
- **Trigger**: `Button Clicks`

#### Tag: GA4 CTA Clicks  
- **Nombre**: `GA4 - CTA Clicks`
- **Tipo**: Evento de Google Analytics: GA4
- **Configuraci√≥n**: `{{GA4 Config}}`
- **Nombre del evento**: `cta_click`
- **Par√°metros**:
  - `cta_text`: `{{DL - CTA Text}}`
  - `cta_position`: `{{DL - CTA Position}}`
  - `page_section`: `{{Get Current Section}}`
- **Trigger**: `CTA Clicks`

#### Tag: GA4 Form Events
- **Nombre**: `GA4 - Form Start`
- **Tipo**: Evento de Google Analytics: GA4
- **Configuraci√≥n**: `{{GA4 Config}}`
- **Nombre del evento**: `form_start`
- **Par√°metros**:
  - `form_name`: `{{DL - Form Name}}`
  - `form_type`: `{{DL - Form Type}}`
- **Trigger**: `Form Start`

- **Nombre**: `GA4 - Form Submit`
- **Tipo**: Evento de Google Analytics: GA4
- **Configuraci√≥n**: `{{GA4 Config}}`
- **Nombre del evento**: `form_submit`
- **Par√°metros**:
  - `form_name`: `{{DL - Form Name}}`
  - `form_type`: `{{DL - Form Type}}`
- **Trigger**: `Form Submit`

#### Tag: GA4 Quote Calculator
- **Nombre**: `GA4 - Quote Events`
- **Tipo**: Evento de Google Analytics: GA4
- **Configuraci√≥n**: `{{GA4 Config}}`
- **Nombre del evento**: `quote_calculator`
- **Par√°metros**:
  - `quote_action`: `{{DL - Quote Action}}`
  - `quote_step`: `{{DL - Quote Step}}`
  - `flow_type`: `{{DL - Flow Type}}`
- **Trigger**: `Quote Start`, `Quote Step Complete`, `Quote Complete`, `Quote Abandon`

#### Tag: GA4 Conversions
- **Nombre**: `GA4 - Conversions`
- **Tipo**: Evento de Google Analytics: GA4
- **Configuraci√≥n**: `{{GA4 Config}}`
- **Nombre del evento**: `conversion`
- **Par√°metros**:
  - `conversion_type`: `{{DL - Conversion Type}}`
  - `value`: `1` (puedes ajustar seg√∫n necesidad)
- **Trigger**: `Conversions`

---

## 6. Eventos Personalizados

### Eventos de Alto Valor para Configurar como Conversiones en GA4:

1. **quote_complete** - Usuario completa cotizador
2. **form_submit** - Usuario env√≠a formulario contacto  
3. **cta_click** (filtrado por botones espec√≠ficos):
   - "Hablar con asesor"
   - "Agendar una reuni√≥n"
   - "Solicitar contacto ahora"

### Audiencias Sugeridas:
- **Usuarios Interesados**: Visitaron `/cotizador` o `/servicios`
- **Lead Calificado**: Completaron formulario o cotizador
- **Alto Engagement**: M√°s de 3 page views en sesi√≥n
- **Abandono Cotizador**: Iniciaron pero no completaron cotizador

---

## 7. Verificaci√≥n y Testing

### 7.1 Usar GTM Preview Mode
1. En GTM, haz clic en "Preview"
2. Ingresa tu URL de desarrollo: `http://localhost:5173`
3. Navega por la aplicaci√≥n y verifica que se disparen los eventos

### 7.2 Verificar eventos en el navegador
```javascript
// Ejecuta en Console del navegador para ver dataLayer
console.log(window.dataLayer);

// Filtrar solo eventos GTM
window.dataLayer.filter(item => item.event);
```

### 7.3 GA4 Real-time Reports
- Ve a GA4 > Reports > Realtime
- Navega por tu aplicaci√≥n 
- Verifica que aparezcan los eventos en tiempo real

### 7.4 GA4 DebugView
- Instala GA4 Debugger Chrome Extension
- Activa debug mode
- Verifica par√°metros de eventos en GA4

---

## üöÄ Lista de Verificaci√≥n Final

- [ ] GTM Container publicado
- [ ] GA4 configurado y conectado
- [ ] Variables creadas en GTM
- [ ] Triggers configurados
- [ ] Tags de eventos funcionando
- [ ] Eventos aparecen en GA4 Real-time
- [ ] Conversiones configuradas en GA4
- [ ] Testing completo en Preview Mode

---

## üìä Eventos Implementados en el C√≥digo

### Navegaci√≥n SPA
```javascript
trackPageView(pageName, pageUrl)
```

### Botones y CTAs  
```javascript
trackButtonClick(buttonName, section, additionalData)
trackCTAClick(ctaText, position, section, destination)
```

### Formularios
```javascript
trackFormStart(formName, formType)
trackFormSubmit(formName, formType, additionalData)  
```

### Cotizador
```javascript
trackQuoteEvent(action, step, data)
// Actions: 'start', 'step_complete', 'abandon', 'complete'
```

### Conversiones
```javascript
trackConversion(conversionType, value, additionalData)
```

---

## üéØ KPIs Sugeridos para Dashboards

1. **Funnel de Conversi√≥n**:
   - Visitantes √∫nicos
   - Usuarios que ven servicios
   - Usuarios que inician cotizador  
   - Usuarios que completan cotizador
   - Usuarios que env√≠an formulario contacto

2. **Engagement**:
   - Tiempo en p√°gina
   - P√°ginas por sesi√≥n
   - Tasa de rebote por p√°gina
   - Clicks en CTAs principales

3. **Cotizador Performance**:
   - Tasa de inicio
   - Tasa de completaci√≥n por paso
   - Puntos de abandono m√°s frecuentes
   - Flujo m√°s utilizado (empresa existente vs nueva)

¬°Con esta configuraci√≥n tendr√°s un tracking completo y profesional de tu aplicaci√≥n Contadoor! üöÄ

---

## üéØ ESTADO ACTUAL DE IMPLEMENTACI√ìN

### ‚úÖ **P√ÅGINAS CON TRACKING GTM COMPLETO**

#### **üè† P√°gina de Inicio** (`/`)
- **Page tracking**: ‚úÖ Implementado
- **Navigation**: ‚úÖ 8 links del men√∫
- **Hero CTAs**: ‚úÖ Botones principales
- **Problem cards**: ‚úÖ 3 tarjetas de dolor
- **Solution cards**: ‚úÖ 3 tarjetas de soluci√≥n
- **Testimonials**: ‚úÖ Interacciones con testimonios
- **FAQ**: ‚úÖ Acordeones expandibles
- **Final CTAs**: ‚úÖ Empezar ahora + Hablar con asesor
- **Total tracking points**: 35+

#### **üí∞ Cotizador** (`/cotizador`)
- **Page tracking**: ‚úÖ `trackQuoteEvent('page_view')`
- **Flow tracking**: ‚úÖ Cada paso del flujo
- **Company selection**: ‚úÖ `quote_has_company_yes/no`
- **Company types**: ‚úÖ `quote_company_type_persona/eirl/spa/ltda_sa`
- **Company sizes**: ‚úÖ `quote_size_emprendiendo/crecimiento/consolidada`
- **Final CTAs**: ‚úÖ `quote_cta_whatsapp` + `quote_cta_meeting`
- **Conversion tracking**: ‚úÖ Con datos de precio (UF/CLP)
- **Total tracking points**: 15+

#### **üõ†Ô∏è Servicios** (`/servicios`)
- **Page tracking**: ‚úÖ `trackPageView('Servicios')`
- **Hero CTAs**: ‚úÖ `services_hero_cta_primary/secondary`
- **Final CTAs**: ‚úÖ `services_final_cta_primary/secondary`
- **Button component**: ‚úÖ Auto-tracking integrado
- **Total tracking points**: 8+

#### **üìû Contacto** (`/contacto`)
- **Page tracking**: ‚úÖ `trackPageView('Contacto')`
- **Form tracking**: ‚úÖ `trackFormStart/Submit`
- **Conversion tracking**: ‚úÖ `trackConversion`
- **WhatsApp CTA**: ‚úÖ `contact_whatsapp_cta`
- **Meeting CTA**: ‚úÖ `contact_meeting_cta`
- **Contact actions**: ‚úÖ Channel tracking
- **Total tracking points**: 10+

#### **üìã P√°ginas Informativas**
- **Como Funciona** (`/como-funciona`): ‚úÖ Page tracking
- **Por Que Contadoor** (`/por-que-contadoor`): ‚úÖ Page tracking
- **Sobre Nosotros** (`/sobre-nosotros`): ‚úÖ Page tracking
- **Blog** (`/blog`): ‚úÖ Page tracking
- **Recursos** (`/recursos`): ‚úÖ Page tracking

### üìä **TOTAL IMPLEMENTADO: 70+ TRACKING POINTS**

### üéØ **EVENTOS GTM CONSOLIDADOS**

Los tracking points se agrupan en estos eventos principales:

1. **`page_view`** - Navegaci√≥n SPA
2. **`button_click`** - Clicks en botones generales
3. **`cta_click`** - CTAs principales (conversi√≥n)
4. **`quote_calculator`** - Todo el flujo del cotizador
5. **`form_start/submit`** - Formularios de contacto
6. **`conversion`** - Conversiones finales
7. **`contact_action`** - Acciones de contacto

### üîß **COMPONENTES CON AUTO-TRACKING**

- **Button.jsx**: ‚úÖ Tracking autom√°tico integrado
- **GTMTracker.jsx**: ‚úÖ SPA page tracking
- **gtm.js**: ‚úÖ Utilidades completas

### üìã **P√ÅGINAS RESTANTES**

- [x] Blog (`/blog`) - ‚úÖ Page tracking implementado
- [x] Recursos (`/recursos`) - ‚úÖ Page tracking implementado
- [ ] Privacidad (`/privacidad`) - No necesario para tracking
- [ ] T√©rminos (`/terminos`) - No necesario para tracking

### üéØ **EVENTOS DE ALTA PRIORIDAD PARA GA4**

Configure estos como **Conversiones** en GA4:

1. **`quote_complete`** - Usuario completa cotizador ‚≠ê
2. **`contact_whatsapp`** - Click en WhatsApp ‚≠ê
3. **`contact_meeting`** - Agenda reuni√≥n ‚≠ê
4. **`form_submit`** - Env√≠a formulario contacto ‚≠ê
5. **`cta_click`** - CTAs principales de conversi√≥n

### üî• **AUDIENCIAS SUGERIDAS GA4**

- **Lead Calificado**: Complet√≥ cotizador OR envi√≥ formulario
- **Alta Intenci√≥n**: Visit√≥ `/cotizador` + `/servicios`
- **Abandono Cotizador**: Inici√≥ pero no complet√≥
- **WhatsApp Users**: Prefieren contacto inmediato

---

## ‚úÖ **CHECKLIST FINAL DE IMPLEMENTACI√ìN**

- [x] GTM Container configurado (GTM-PHGF2PCM)
- [x] Tracking en p√°gina Inicio (35+ points)
- [x] Tracking en Cotizador (15+ points)
- [x] Tracking en Servicios (8+ points)
- [x] Tracking en Contacto (10+ points)
- [x] Tracking en p√°ginas informativas (3 p√°ginas)
- [x] Componente Button con auto-tracking
- [x] SPA navigation tracking
- [x] Documentaci√≥n actualizada
- [ ] Variables configuradas en GTM
- [ ] Triggers configurados en GTM
- [ ] Tags de GA4 configurados
- [ ] Eventos de conversi√≥n en GA4
- [ ] Testing en Preview Mode
- [ ] Validaci√≥n en GA4 Real-time

üöÄ **¬°Implementaci√≥n GTM completa y lista para configuraci√≥n en Google Tag Manager!**